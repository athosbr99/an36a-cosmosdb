\documentclass[12pt]{article}
\usepackage{sbc-template}
\usepackage{graphicx,url,float}
\usepackage{hyperref}
\usepackage[alf]{abntex2cite}
\usepackage[brazil]{babel}   
\usepackage[utf8]{inputenc} 
     
\sloppy

\title{Azure CosmosDB: Estudo e aplicação}

\author{Athos Castro Moreno}

\address{Departamento de wComputação - Universidade Tecnológica Federal do Paraná
  (UTFPR)\\
  Avenida Alberto Carazzai, 1640 -- 86300000 -- Cornélio Procópio -- PR -- Brasil
  \email{athos@alunos.utfpr.edu.br}
}

\begin{document} 

\maketitle

\begin{resumo} 
\end{resumo}

\section{Introdução}

\section{Problematização} 

\subsection{NoSQL}
Na indústria de tecnologia de informação é comum a utilização dos bancos de dados relacionais que usufruem da linguagem SQL para as operações. Com a crescente demanda
de maleabilidade na modelagem de um banco de dados em empresas com requisitos que não estão com uma estrutura de dados bem definida. precisam de um desenvolvimento mais rápido
ou estão em constante mudança, foi necessária a utilização de soluções além de bancos de dados relacionais \cite{Oliveira2011}.

O conceito de bancos de dados não relacionais existe desde 1960 e ganhou popularidade entre 2007 e 2010, principalmente com o anúncio do Amazon Dynamo, serviço de uso interno no \textit{e-commerce}
da Amazon, que posteriormente se tornou a base do AWS DynamoDB, serviço NoSQL disponível para uso na Amazon Web Services \cite{DeCandia2007}.
A primeira implementação NoSQL foi criada por Carlo Stozzi, aonde um banco de dados \textit{open source} em shell não utilizava nenhuma interface SQL para ser manipulado \cite{Lith2010}. 

Cada implementação NoSQL possuí uma abordagem diferente, tais como \cite{Lith2010} \cite{Leavitt2010}:

\begin{itemize}
	\item \textbf{\textit{Key-value}:} Armazena um par de chaves e valores, funcionando com um \textit{array} associativo. Pode armazenar dados estruturados ou dados sem estrutura.
	\item \textbf{Orientado a documentos:} Uma subclasse do \textit{key-value}, tendo diferença no processamento dos dados através da estrutura interna do documento. Podem ser utilizados 
	os formatos de arquivos XML, YAML, JSON, BSON, entre outras opções.
	\item \textbf{Orientado a colunas:} Nessa abordagem as informações são armazenadas em colunas. É otimizado para recuperação rápida de dados, uso em aplicativos 
	analíticos e reduz requerimentos de E/S de disco e quantidade de dados necessário a serem carregados.
\end{itemize}

O uso de um banco de dados NoSQL é recomendado para ambientes dinâmicos, que precisem ser escaláveis entre várias máquinas de maneira mais rápida, com uma estrutura de dados que não está bem 
definida ou em constante mudança. É importante ressaltar que o NoSQL não tem como foco substituir todos os bancos relacionais existentes e sim fornecer uma alternativa para os que 
precisam de mais velocidade e estar menos presos a uma modelagem \cite{Oliveira2011} \cite{Lith2010} \cite{Leavitt2010}. 

\subsection{Azure CosmosDB}
O produto CosmosDB iniciou em 2010 como um projeto interno na Microsoft, conhecido como Projeto Florence. O objetivo do projeto era resolver problemas de desenvolvimento em aplicações de Internet
que eram utilizadas em larga escala, similar a razão da Amazon ter criado o Dynamo. Em 2015 o projeto foi disponibilizado para usuários do Azure com o nome de DocumentDB. Em 2017, no evento Build 2017,
o DocumentDB foi lançado com o nome de CosmosDB, com as funcionalidades já existentes, mais a distribuição global presente hoje \cite{Paz2018}.

Além das vantagens do NoSQL, o CosmosDB fornece outras funcionalidades. A mais importante é a georeplicação via portal nos \textit{datacenters} da Azure e além desta, tem baixa latência de leitura/escrita,
serviço autogerenciado -- não é necessário atualizar ou modificar nenhum \textit{software}, suporta múltiplos \textit{data models}, escalabilidade de custo e \textit{failover} automático, se configurado \cite{Paz2018} \cite{Shukla2015}.

É importante lembrar que o CosmosDB, apesar de utilizar e suportar diversas tecnologias \textit{open source}, é um serviço proprietário da Microsoft e seu uso é limitado dentro dos 
servidores da Azure.

\subsubsection{Modelos de Consistência}
O CosmosDB possui cinco modelos de consistência que podem ser escolhidos de acordo com a necessidade do aplicativo em que será usado. Cada modelo de consistência possui vantagens, desvantagens e limitações.
É possível entre \cite{Paz2018} \cite{Shukla2015}:

\begin{itemize}
	\item \textbf{\textit{Strong Consistency:}} Garante que toda leitura de um item irá retornar a versão mais recente deste item e o usuário nunca irá ver uma versão incompleta do item. 
	É o mesmo modelo de consistência existente em bancos de dados relacionais, por isso o CosmosDB não permite que quando o modelo \textit{strong consistency} está configurado, não é possível utilizar a funcionalidade
	de replicação global.
	\item \textbf{\textit{Eventual Consistency:}} Garante que eventualmente, todas as replicas irão, eventualmente, convergir para refletir a escrita mais recente. Em termos de consistência de dados é um modelo fraco, mas,
	oferece a menor latência de todos os modelos oferecidos. 
	\item \textbf{\textit{Bound Staleness Consistency Model:}} Neste modo é possível afirmar que as leituras irão atrasar entre as escritas por um numero K de operações ou em um intervalo t de tempo. O valor K deve estar entre
	10 e 1000000 operações ou entre 100000 e 1000000 se o banco é globalmente distribuído. O valor t pode ser entre cinco segundos e um dia ou cinco minutos e um dia para bancos distribuídos globalmente.
	\item \textbf{\textit{Session Consistency Model:}} O nível de consistência é definido na sessão do cliente. Todas as leituras e escritas estão sempre atualizadas dentro da mesma sessão, durante seu tempo de vida. Esse modelo fornece uma
	alta taxa de transferência e baixas taxas de latência de escrita e é o modo padrão para toda conta nova do CosmosDB. 
\end{itemize}

\subsubsection{Como utilizar}
O CosmosDB é um serviço pago da Azure, sendo necessário criar uma conta na Azure para utilizar. Para usuários novos, a Azure fornece um ano de serviços selecionados de uso gratuito, incluindo o CosmosDB. É necessário possuir um cartão de crédito
para ativar a conta da Azure e utilizar os serviços no período gratuito. As figuras \ref{fig:az1} e \ref{fig:az2} mostram o processo de criação de um banco de dados MongoDB novo no CosmosDB.

\begin{figure}[H]
	\label{fig:az1}
	\caption{Criação do banco de dados CosmosDB} 
	\includegraphics[scale=0.42]{img/az1.png}
	\centering
\end{figure}

\begin{figure}[H]
	\label{fig:az2}
	\caption{Esperando o processo terminar a criação da instância}
	\includegraphics[scale=0.45]{img/az2.png}
	\centering
\end{figure}

\begin{figure}[H]
	\label{fig:az3}
	\caption{\textit{String} de conexão do MongoDB}
	\includegraphics[scale=0.37]{img/az3.png}
	\centering
\end{figure}

\bibliography{bibliografia}

\end{document}
